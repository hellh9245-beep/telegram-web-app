<!DOCTYPE html>
<html>
<head>
    <title>üõçÔ∏è –ú–æ–π –º–∞–≥–∞–∑–∏–Ω</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f0f2f5;
            padding: 20px;
            max-width: 600px;
            margin: 0 auto;
        }
        .tab {
            display: none;
        }
        .active {
            display: block;
        }
        .tabs {
            display: flex;
            margin-bottom: 20px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
        }
        .tab-btn {
            flex: 1;
            padding: 15px;
            border: none;
            background: #667eea;
            color: white;
            cursor: pointer;
            font-size: 16px;
        }
        .tab-btn.active {
            background: #764ba2;
        }
        .product {
            background: white;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .product-image {
            width: 100%;
            height: 150px;
            border-radius: 8px;
            background: #667eea;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
            margin-bottom: 10px;
        }
        .price {
            color: #ff6b6b;
            font-weight: bold;
            font-size: 18px;
            margin: 10px 0;
        }
        .buy-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            width: 100%;
        }
        .admin-btn {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .form-group {
            margin: 10px 0;
        }
        input, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        .save-btn {
            background: #4caf50;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 5px;
            cursor: pointer;
            width: 100%;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <div class="tabs">
        <button class="tab-btn active" onclick="showTab('shop')">üõçÔ∏è –ú–∞–≥–∞–∑–∏–Ω</button>
        <button class="tab-btn" onclick="showTab('admin')">‚öôÔ∏è –ê–¥–º–∏–Ω–∫–∞</button>
    </div>

    <!-- –ú–∞–≥–∞–∑–∏–Ω –¥–ª—è –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π -->
    <div id="shop" class="tab active">
        <h1>üõçÔ∏è –ú–æ–π –º–∞–≥–∞–∑–∏–Ω</h1>
        <p>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! –í—ã–±–µ—Ä–∏—Ç–µ —Ç–æ–≤–∞—Ä—ã:</p>
        <div id="products-list">
            <!-- –¢–æ–≤–∞—Ä—ã –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
        </div>
    </div>

    <!-- –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å -->
    <div id="admin" class="tab">
        <h1>‚öôÔ∏è –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h1>
        
        <div class="form-group">
            <input type="text" id="product-name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞">
        </div>
        <div class="form-group">
            <input type="number" id="product-price" placeholder="–¶–µ–Ω–∞ (—Ä—É–±)">
        </div>
        <div class="form-group">
            <textarea id="product-desc" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞" rows="3"></textarea>
        </div>
        <div class="form-group">
            <input type="text" id="product-image" placeholder="URL –∫–∞—Ä—Ç–∏–Ω–∫–∏ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)">
        </div>
        
        <button class="save-btn" onclick="addProduct()">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</button>
        
        <h3>–ú–æ–∏ —Ç–æ–≤–∞—Ä—ã:</h3>
        <div id="admin-products">
            <!-- –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
        </div>
    </div>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ –∏–∑ localStorage
        let products = JSON.parse(localStorage.getItem('store_products')) || [];

        // –ü–æ–∫–∞–∑ –≤–∫–ª–∞–¥–æ–∫
        function showTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(tabName).classList.add('active');
            document.querySelector(`[onclick="showTab('${tabName}')"]`).classList.add('active');
            
            if (tabName === 'shop') {
                loadProducts();
            } else if (tabName === 'admin') {
                loadAdminProducts();
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –º–∞–≥–∞–∑–∏–Ω
        function loadProducts() {
            const productsList = document.getElementById('products-list');
            productsList.innerHTML = '';

            products.forEach((product, index) => {
                const productHTML = `
                    <div class="product">
                        <div class="product-image">
                            ${product.image ? `<img src="${product.image}" alt="${product.name}" style="width:100%;height:100%;object-fit:cover;">` : 'üéÅ –§–æ—Ç–æ —Ç–æ–≤–∞—Ä–∞'}
                        </div>
                        <h3>${product.name}</h3>
                        <p>${product.description}</p>
                        <div class="price">${product.price} —Ä—É–±.</div>
                        <button class="buy-btn" onclick="buyProduct(${index})">–ö—É–ø–∏—Ç—å</button>
                    </div>
                `;
                productsList.innerHTML += productHTML;
            });
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∞–¥–º–∏–Ω–∫–µ
        function loadAdminProducts() {
            const adminProducts = document.getElementById('admin-products');
            adminProducts.innerHTML = '';

            products.forEach((product, index) => {
                const adminHTML = `
                    <div class="product">
                        <h3>${product.name}</h3>
                        <p>${product.description}</p>
                        <div class="price">${product.price} —Ä—É–±.</div>
                        <button class="admin-btn" onclick="editProduct(${index})">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                        <button class="admin-btn" onclick="deleteProduct(${index})">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
                    </div>
                `;
                adminProducts.innerHTML += adminHTML;
            });
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
        function addProduct() {
            const name = document.getElementById('product-name').value;
            const price = document.getElementById('product-price').value;
            const description = document.getElementById('product-desc').value;
            const image = document.getElementById('product-image').value;

            if (!name || !price || !description) {
                tg.showPopup({
                    title: "‚ùå –û—à–∏–±–∫–∞",
                    message: "–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è!"
                });
                return;
            }

            products.push({
                name: name,
                price: price,
                description: description,
                image: image
            });

            localStorage.setItem('store_products', JSON.stringify(products));
            
            // –û—á–∏—Å—Ç–∫–∞ —Ñ–æ—Ä–º—ã
            document.getElementById('product-name').value = '';
            document.getElementById('product-price').value = '';
            document.getElementById('product-desc').value = '';
            document.getElementById('product-image').value = '';

            tg.showPopup({
                title: "‚úÖ –£—Å–ø–µ—Ö",
                message: "–¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω!"
            });

            loadAdminProducts();
        }

        // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
        function editProduct(index) {
            const product = products[index];
            
            document.getElementById('product-name').value = product.name;
            document.getElementById('product-price').value = product.price;
            document.getElementById('product-desc').value = product.description;
            document.getElementById('product-image').value = product.image || '';

            // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–π —Ç–æ–≤–∞—Ä
            products.splice(index, 1);
            localStorage.setItem('store_products', JSON.stringify(products));
            loadAdminProducts();
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
        function deleteProduct(index) {
            if (confirm("–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ç–æ–≤–∞—Ä?")) {
                products.splice(index, 1);
                localStorage.setItem('store_products', JSON.stringify(products));
                loadAdminProducts();
                loadProducts();
            }
        }

        // –ü–æ–∫—É–ø–∫–∞ —Ç–æ–≤–∞—Ä–∞
        function buyProduct(index) {
            const product = products[index];
            tg.showPopup({
                title: "‚úÖ –¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É",
                message: `${product.name} - ${product.price} —Ä—É–±.\n\n–°–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞–º–∏ –¥–ª—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞: @–≤–∞—à_–∞–∫–∫–∞—É–Ω—Ç`,
                buttons: [{type: "ok", text: "–ü–æ–Ω—è—Ç–Ω–æ"}]
            });
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
        loadProducts();
    </script>
</body>
</html>
